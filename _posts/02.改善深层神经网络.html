<html>
<head>
  <title>02.改善深层神经网络</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, MWS); Windows/10.0.0 (Win64);"/>
  <meta name="content-class" content="maxiang"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="476"/>
<h1>02.改善深层神经网络</h1>

<div><span lang="v2" style="color: #2c3f51; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif; line-height: 1.6; background: none;"><del style="position:relative;display:block;z-index:10;"><a href="http://maxiang.io/#/?provider=evernote&amp;guid=b1ff6a1e-2657-4ff6-b2c7-11408bdd0db9&amp;notebook=%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0_%E5%90%B4%E6%81%A9%E8%BE%BE" style="position: absolute;color: #FFF;text-decoration: none;font-size: 12px;height: 25px;border-radius: 0;margin-top: -20px;right: 15px;background: rgba(0, 0, 0, 0);border-left: 10px solid #BB3A34;border-right: 10px solid #BB3A34;border-bottom: 5px solid rgba(0, 0, 0, 0);width: 0;text-indent:-100000px;">Edit</a></del><div style="color: #2c3f51; font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif; line-height: 1.6;">
                        
                    

<p style="margin: 0 0 1.1em; line-height: 1.6;">02.改善深层神经网络 <br/>
</p><p style="margin: 0 0 1.1em; color: rgba(44,63,81,0.3); line-height: 1.6;"><code style="font-family: 'Source Code Pro',monospace; font-size: .9em; background-color: #f9f2f4; white-space: normal; padding: 2px 5px; border-radius: 0; color: #fff; background: rgba(44,63,81,0.3); margin-right: 6px;">深度学习_吴恩达</code> <code style="font-family: 'Source Code Pro',monospace; font-size: .9em; background-color: #f9f2f4; white-space: normal; padding: 2px 5px; color: rgba(44,63,81,0.5); border-radius: 0; background: rgba(102,128,153,0.075);">深度学习</code> <code style="font-family: 'Source Code Pro',monospace; font-size: .9em; background-color: #f9f2f4; white-space: normal; padding: 2px 5px; color: rgba(44,63,81,0.5); border-radius: 0; background: rgba(102,128,153,0.075);">吴恩达</code> </p><p style="margin: 0 0 1.1em; line-height: 1.6;"></p>

<div style="line-height: 1.6;"><div style="line-height: 1.6;"><div style="line-height: 1.6;">
<ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;">
<li style="line-height: 1.6;"><a href="#02改善深层神经网络" style="background: transparent; color: #1980e6; text-decoration: none;">02.改善深层神经网络</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;">
<li style="line-height: 1.6;"><a href="#第一周" style="background: transparent; color: #1980e6; text-decoration: none;">第一周</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;">
<li style="line-height: 1.6;"><a href="#1-1-训练开发测试集" style="background: transparent; color: #1980e6; text-decoration: none;">1-1 训练/开发/测试集</a></li>
<li style="line-height: 1.6;"><a href="#1-2-偏差方差" style="background: transparent; color: #1980e6; text-decoration: none;">1-2 偏差/方差</a></li>
<li style="line-height: 1.6;"><a href="#1-3-机器学习基础" style="background: transparent; color: #1980e6; text-decoration: none;">1-3 机器学习基础</a></li>
<li style="line-height: 1.6;"><a href="#1-4-正则化" style="background: transparent; color: #1980e6; text-decoration: none;">1-4 正则化</a></li>
<li style="line-height: 1.6;"><a href="#1-5-为什么正则化可以减少过拟合" style="background: transparent; color: #1980e6; text-decoration: none;">1-5 为什么正则化可以减少过拟合</a></li>
<li style="line-height: 1.6;"><a href="#1-6-dropoutinverted-dropout" style="background: transparent; color: #1980e6; text-decoration: none;">1-6 Dropout(Inverted dropout)</a></li>
<li style="line-height: 1.6;"><a href="#1-7-理解fropout" style="background: transparent; color: #1980e6; text-decoration: none;">1-7 理解Fropout</a></li>
<li style="line-height: 1.6;"><a href="#1-8-其他正则化技术" style="background: transparent; color: #1980e6; text-decoration: none;">1-8 其他正则化技术</a></li>
<li style="line-height: 1.6;"><a href="#1-9-正则化输入-normalization-training-sets" style="background: transparent; color: #1980e6; text-decoration: none;">1-9 正则化输入 Normalization training sets</a></li>
<li style="line-height: 1.6;"><a href="#1-10-梯度消失和爆炸" style="background: transparent; color: #1980e6; text-decoration: none;">1-10 梯度消失和爆炸</a></li>
<li style="line-height: 1.6;"><a href="#1-11-神经网络的权重初始化" style="background: transparent; color: #1980e6; text-decoration: none;">1-11 神经网络的权重初始化</a></li>
<li style="line-height: 1.6;"><a href="#1-12-梯度的数值逼近" style="background: transparent; color: #1980e6; text-decoration: none;">1-12 梯度的数值逼近</a></li>
<li style="line-height: 1.6;"><a href="#1-13-梯度检验" style="background: transparent; color: #1980e6; text-decoration: none;">1-13 梯度检验</a></li>
<li style="line-height: 1.6;"><a href="#1-14-梯度检验经验" style="background: transparent; color: #1980e6; text-decoration: none;">1-14 梯度检验经验</a></li>
<li style="line-height: 1.6;"><a href="#第一周第一次作业" style="background: transparent; color: #1980e6; text-decoration: none;">第一周第一次作业</a></li>
<li style="line-height: 1.6;"><a href="#第一周第二次作业" style="background: transparent; color: #1980e6; text-decoration: none;">第一周第二次作业</a></li>
<li style="line-height: 1.6;"><a href="#第一周第三次作业" style="background: transparent; color: #1980e6; text-decoration: none;">第一周第三次作业</a></li>
</ul>
</li>
<li style="line-height: 1.6;"><a href="#第二周" style="background: transparent; color: #1980e6; text-decoration: none;">第二周</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;">
<li style="line-height: 1.6;"><a href="#21-mini-batch梯度下降法" style="background: transparent; color: #1980e6; text-decoration: none;">2.1 Mini-batch梯度下降法</a></li>
<li style="line-height: 1.6;"><a href="#22-理解mini-batch梯度下降法" style="background: transparent; color: #1980e6; text-decoration: none;">2.2 理解mini-batch梯度下降法</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;">
<li style="line-height: 1.6;"><a href="#损失表现" style="background: transparent; color: #1980e6; text-decoration: none;">损失表现</a></li>
<li style="line-height: 1.6;"><a href="#选择mini-batch-size" style="background: transparent; color: #1980e6; text-decoration: none;">选择mini-batch size</a></li>
</ul>
</li>
<li style="line-height: 1.6;"><a href="#23-指数加权平均" style="background: transparent; color: #1980e6; text-decoration: none;">2.3 指数加权平均</a></li>
<li style="line-height: 1.6;"><a href="#24-理解指数加权平均" style="background: transparent; color: #1980e6; text-decoration: none;">2.4 理解指数加权平均</a></li>
<li style="line-height: 1.6;"><a href="#25-指数加权平均的偏差修正bias-correction" style="background: transparent; color: #1980e6; text-decoration: none;">2.5 指数加权平均的偏差修正(bias correction)</a></li>
<li style="line-height: 1.6;"><a href="#26-动量梯度下降法momentum" style="background: transparent; color: #1980e6; text-decoration: none;">2.6 动量梯度下降法Momentum</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;">
<li style="line-height: 1.6;"><a href="#implementation-details" style="background: transparent; color: #1980e6; text-decoration: none;">Implementation details</a></li>
</ul>
</li>
<li style="line-height: 1.6;"><a href="#27-rmsprop" style="background: transparent; color: #1980e6; text-decoration: none;">2.7 RMSprop</a></li>
<li style="line-height: 1.6;"><a href="#28-adam-优化算法" style="background: transparent; color: #1980e6; text-decoration: none;">2.8 Adam 优化算法</a></li>
<li style="line-height: 1.6;"><a href="#29-学习率衰减" style="background: transparent; color: #1980e6; text-decoration: none;">2.9 学习率衰减</a></li>
<li style="line-height: 1.6;"><a href="#210-局部最优的问题" style="background: transparent; color: #1980e6; text-decoration: none;">2.10 局部最优的问题</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>



<h1 style="font-size: 41.6px; margin: 1.2em 0 .6em 0; font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; text-align: start;"><a name="02改善深层神经网络" style="background: transparent; color: #1980e6; text-decoration: none;"></a>02.改善深层神经网络</h1>



<h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 34.4px; margin: 1.2em 0 .6em 0; text-align: start;"><a name="第一周" style="background: transparent; color: #1980e6; text-decoration: none;"></a>第一周</h2>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-1-训练开发测试集" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-1 训练/开发/测试集</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">以前一般使用7:3划分训练集测试集或6:2:2 。大数据下通常需要用验证集快速验证多种算法的优劣，所以可以去小一些。 <br/>
百万数据集98：1：1% <br/>
确保验证集合测试集的数据来自同一分布</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-2-偏差方差" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-2 偏差/方差</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">欠拟合：偏差过高  过拟合：方差过高 <br/>
高方差：训练集和验证集的错误率相差过大  <br/>
高偏差：与人类等实际分类效果对比太差 <br/>
如果可以确定最优方差 然后去和偏差方差作比较来评价模型</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-3-机器学习基础" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-3 机器学习基础</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">High bias? </p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">Bigger network</li>
<li style="line-height: 1.6;">Train longer </li>
<li style="line-height: 1.6;">NN architecture search (可选) <br/>
拟合训练集后，再看 High variance?</li>
<li style="line-height: 1.6;">More data</li>
<li style="line-height: 1.6;">regularization</li>
<li style="line-height: 1.6;">NN architecture search (可选)</li>
</ul>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-4-正则化" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-4 正则化</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">L1 正则化 <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__ae4fb5973f393577570881fc24fc2054" type="image/png" data-filename="__SVG__ae4fb5973f393577570881fc24fc2054" height="8.7363325" longdesc="__SVG__ae4fb5973f393577570881fc24fc2054" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="11.361350000000002"/></span></span></span>稀疏，但没有压缩模型减少内存 <br/>
L2 正则化又称<strong style="font-weight: bold; line-height: 1.6;">权重衰减(Weight Decay)</strong> 公式可见权重在减小</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-5-为什么正则化可以减少过拟合" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-5 为什么正则化可以减少过拟合</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">L2 正则化防止过拟合 直观经验是权重越多接近于0 模型越简单(存疑) <br/>
以<code style="font-family: 'Source Code Pro',monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">Sigmoid</code>为例 当权重过小时候，<code style="font-family: 'Source Code Pro',monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">Sigmoid</code>是接近线性的，整个网络是线性的从而使模型变为简单来减少过拟合</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-6-dropoutinverted-dropout" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-6 Dropout(Inverted dropout)</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">d3 = np.random.rand(a3.shape[0], a3.shape[1]) &lt; keep_prob</code> <br/>
<code style="font-family: 'Source Code Pro',monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">a3 /= keep_prob</code> <br/>
以<strong style="font-weight: bold; line-height: 1.6;">Hinton</strong>论文中提出的<em style="line-height: 1.6;">Dropout</em>在测试集上是将概率<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__2ec6e630f199f589a2402fdf3e0289d5" type="image/png" data-filename="__SVG__2ec6e630f199f589a2402fdf3e0289d5" height="12.236350000000002" longdesc="__SVG__2ec6e630f199f589a2402fdf3e0289d5" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="9.611350000000002"/></span></span></span>应用到神经元的输出边上 <br/>
为了简化测试集的操作，在训练时候每个神经元的输出都降低为权重<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__b6bd4fb45663b60f83a799556b0eeffb" type="image/png" data-filename="__SVG__b6bd4fb45663b60f83a799556b0eeffb" height="15.736350000000002" longdesc="__SVG__b6bd4fb45663b60f83a799556b0eeffb" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="21.86135"/></span></span></span> 这样就不需要在测试集做额外操作</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-7-理解fropout" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-7 理解Fropout</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">Dropout 有效性体现：</p>

<ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">等效正则化，使网络更简单</li>
<li style="line-height: 1.6;">神经元不在完全依赖特定的输入神经元  </li>
</ol>

<p style="margin: 0 0 1.1em; line-height: 1.6;">可以设置不同层<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__ae4fb5973f393577570881fc24fc2054 [1]" type="image/png" data-filename="__SVG__ae4fb5973f393577570881fc24fc2054" height="8.7363325" longdesc="__SVG__ae4fb5973f393577570881fc24fc2054" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="11.361350000000002"/></span></span></span>的dropout rate  设置为1表示不使用dropout <br/>
<em style="line-height: 1.6;">Dropout</em>主要同于计算机视觉(CV)，当过拟合的时候可以在使用 <br/>
缺点：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">损失函数的定义不对明确</li>
<li style="line-height: 1.6;">调试困难(先固定为1， J递减再开启)</li>
</ul>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-8-其他正则化技术" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-8 其他正则化技术</h3>

<ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">Data Augmentation 数据增强 如 图片旋转、裁剪、扭曲</li>
<li style="line-height: 1.6;">early stooping have a mid-size rate <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__2d2b0efad75a69ae3ae3e4744a49713c" type="image/png" data-filename="__SVG__2d2b0efad75a69ae3ae3e4744a49713c" height="14.861350000000002" longdesc="__SVG__2d2b0efad75a69ae3ae3e4744a49713c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="44.5977"/></span></span></span> <br/>
通常的训练步骤： <br/>
<ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;">
<li style="line-height: 1.6;">优化代价函数J(GD/ Momentum/ RMRprop /Adam)</li>
<li style="line-height: 1.6;">避免过拟合(正则化) | 减少方差(正交化) <br/>
early stooping 不能独立处理问题1 2</li></ol></li>
</ol>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-9-正则化输入-normalization-training-sets" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-9 正则化输入 Normalization training sets</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">0均值 1方差 <br/>
当特征范围不一致时候使用归一化，加速<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__8eb543f68dac24748e65e2e4c5fc968c" type="image/png" data-filename="__SVG__8eb543f68dac24748e65e2e4c5fc968c" height="12.236350000000002" longdesc="__SVG__8eb543f68dac24748e65e2e4c5fc968c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="8.7363325"/></span></span></span>下降</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-10-梯度消失和爆炸" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-10 梯度消失和爆炸</h3>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-11-神经网络的权重初始化" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-11 神经网络的权重初始化</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__0b1645bf4323f2df41bc7e1b1aaeaf4b" type="image/png" data-filename="__SVG__0b1645bf4323f2df41bc7e1b1aaeaf4b" height="14.861350000000002" longdesc="__SVG__0b1645bf4323f2df41bc7e1b1aaeaf4b" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="202.91775"/></span></span></span>  <br/>
设置<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__75360181008bbffb1121b6d5d8754bee" type="image/png" data-filename="__SVG__75360181008bbffb1121b6d5d8754bee" height="18.36135" longdesc="__SVG__75360181008bbffb1121b6d5d8754bee" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="125.94574999999999"/></span></span></span>=<code style="font-family: 'Source Code Pro',monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">np.random.rand(shape)*np.sqrt(1/n[l-1])</code> <br/>
最后一项 <br/>
<em style="line-height: 1.6;">tanh</em> 使用<em style="line-height: 1.6;">Xavier </em>初始化，<em style="line-height: 1.6;">ReLU</em>使用公式2</p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">Xavier 初始化，公式： <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__377e13a748289068cd42472ae9853c8e" type="image/png" data-filename="__SVG__377e13a748289068cd42472ae9853c8e" height="33.2227" longdesc="__SVG__377e13a748289068cd42472ae9853c8e" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="48.9727"/></span></span></span> <br/>
  公式： <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7542e3df6e5c2feff34b0dba42c59907" type="image/png" data-filename="__SVG__7542e3df6e5c2feff34b0dba42c59907" height="33.2227" longdesc="__SVG__7542e3df6e5c2feff34b0dba42c59907" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="72.5977"/></span></span></span></p>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;">此超参数的调节优先等级比较低</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-12-梯度的数值逼近" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-12 梯度的数值逼近</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">双边误差法</strong>：<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__d0d4515b61094229fcffecfa392ce3bc" type="image/png" data-filename="__SVG__d0d4515b61094229fcffecfa392ce3bc" height="25.36135" longdesc="__SVG__d0d4515b61094229fcffecfa392ce3bc" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="130.32074999999998"/></span></span></span></p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-13-梯度检验" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-13 梯度检验</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__37355aaf555c19acde0a44e655446dc1" type="image/png" data-filename="__SVG__37355aaf555c19acde0a44e655446dc1" height="15.736350000000002" longdesc="__SVG__37355aaf555c19acde0a44e655446dc1" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="77.83396250000001"/></span></span></span> <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f7ed66ae8d8f913f33d096b40bf1fcfd" type="image/png" data-filename="__SVG__f7ed66ae8d8f913f33d096b40bf1fcfd" height="15.736350000000002" longdesc="__SVG__f7ed66ae8d8f913f33d096b40bf1fcfd" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="33.2227"/></span></span></span> 效果great <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c8a47f21829cbaf8b90f04d3d51c6986" type="image/png" data-filename="__SVG__c8a47f21829cbaf8b90f04d3d51c6986" height="12.236350000000002" longdesc="__SVG__c8a47f21829cbaf8b90f04d3d51c6986" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="35.86135"/></span></span></span>效果wrong</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="02.改善深层神经网络_files/.1528095126219.png" type="image/png" data-filename="./1528095126219.png" alt="Alt text" longdesc="./1528095126219.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="1-14-梯度检验经验" style="background: transparent; color: #1980e6; text-decoration: none;"></a>1-14 梯度检验经验</h3>

<ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">Dont use in training - only to debug      </li>
<li style="line-height: 1.6;">If algorithm fails grad check, look at components to try to identify bug</li>
<li style="line-height: 1.6;">Rember regularization</li>
<li style="line-height: 1.6;">Doesn’t work with dropout</li>
<li style="line-height: 1.6;">Run ai random initialization;perhaps again after some training</li>
</ol>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="第一周第一次作业" style="background: transparent; color: #1980e6; text-decoration: none;"></a>第一周第一次作业</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">权重初始化作用：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">加速梯度收敛 </li>
<li style="line-height: 1.6;">增加泛化能力</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">权重初始化对比</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">0 </li>
<li style="line-height: 1.6;">随机 </li>
<li style="line-height: 1.6;">HE三种方式  <br/>
结果逐渐变好 其中<em style="line-height: 1.6;">He Initialization</em> (<a href="https://www.leiphone.com/news/201703/3qMp45aQtbxTdzmK.html" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">Xavier Initialization变种 参考</a>)</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">权重为0 <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f238b6518d740733fc373c291617d1fc" type="image/png" data-filename="__SVG__f238b6518d740733fc373c291617d1fc" height="10.486350000000002" longdesc="__SVG__f238b6518d740733fc373c291617d1fc" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="27.98635"/></span></span></span>不下降模型无效 <br/>
权重过大，没有效果</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="第一周第二次作业" style="background: transparent; color: #1980e6; text-decoration: none;"></a>第一周第二次作业</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">正则化技术很有效</p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="第一周第三次作业" style="background: transparent; color: #1980e6; text-decoration: none;"></a>第一周第三次作业</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">梯度检验： <br/>
</p><div style="line-height: 1.6;"><div style="max-width: none; position: relative; width: 100%; text-indent: 0; margin: 1em 0; max-height: none; min-width: 0; min-height: 0; line-height: 1.6; text-align: center; display: block;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6; display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="line-height: 1.6; display: inline-block; position: relative; width: 63.494ex; height: 5.301ex; vertical-align: -2.048ex;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__8939b4e4ffade8916a08ca8f337908fe" type="image/png" data-filename="__SVG__8939b4e4ffade8916a08ca8f337908fe" height="39.36135" longdesc="__SVG__8939b4e4ffade8916a08ca8f337908fe" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="460.947375"/></span></span></span></span></div></div><p style="margin: 0 0 1.1em; line-height: 1.6;"></p>



<h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 34.4px; margin: 1.2em 0 .6em 0; text-align: start;"><a name="第二周" style="background: transparent; color: #1980e6; text-decoration: none;"></a>第二周</h2>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="21-mini-batch梯度下降法" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.1 Mini-batch梯度下降法</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">默认梯度下降是将所有数据进行计算实现一部梯度下降 <br/>
分批次 : <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__57de87bf0270df3913f3747c4f94e0d2" type="image/png" data-filename="__SVG__57de87bf0270df3913f3747c4f94e0d2" height="18.36135" longdesc="__SVG__57de87bf0270df3913f3747c4f94e0d2" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="186.30675"/></span></span></span> <br/>
同样：<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__a95c5167f01e2389d760ba5f6107869c" type="image/png" data-filename="__SVG__a95c5167f01e2389d760ba5f6107869c" height="18.36135" longdesc="__SVG__a95c5167f01e2389d760ba5f6107869c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="184.55675"/></span></span></span> <br/>
mini  batch <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__6c6fedc5c1ce9c2ee3f4504bd6435410" type="image/png" data-filename="__SVG__6c6fedc5c1ce9c2ee3f4504bd6435410" height="17.48635" longdesc="__SVG__6c6fedc5c1ce9c2ee3f4504bd6435410" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="82.20896250000001"/></span></span></span>  </p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__ad769e751231d17313953f80471b27a4" type="image/png" data-filename="__SVG__ad769e751231d17313953f80471b27a4" height="14.861350000000002" longdesc="__SVG__ad769e751231d17313953f80471b27a4" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="20.98635"/></span></span></span>表示训练集中第<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__77a3b857d53fb44e33b53e4c8b68351a" type="image/png" data-filename="__SVG__77a3b857d53fb44e33b53e4c8b68351a" height="12.236350000000002" longdesc="__SVG__77a3b857d53fb44e33b53e4c8b68351a" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="4.3613325"/></span></span></span>个训练样本 <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__a443d3d929040cf6820ae98cb2365abd" type="image/png" data-filename="__SVG__a443d3d929040cf6820ae98cb2365abd" height="16.61135" longdesc="__SVG__a443d3d929040cf6820ae98cb2365abd" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="20.11135"/></span></span></span>表示神经网络的层数 <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__2408577fc6bb62c5ffae0709ea44c473" type="image/png" data-filename="__SVG__2408577fc6bb62c5ffae0709ea44c473" height="14.861350000000002" longdesc="__SVG__2408577fc6bb62c5ffae0709ea44c473" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="60.3477"/></span></span></span>表示不同的mini batch  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__cbfb1b2a33b28eab8a3e59464768e810" type="image/png" data-filename="__SVG__cbfb1b2a33b28eab8a3e59464768e810" height="12.236350000000002" longdesc="__SVG__cbfb1b2a33b28eab8a3e59464768e810" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="11.361350000000002"/></span></span></span>维度<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__b88556f9393c4d0ddb57e0f7fc2e96a6" type="image/png" data-filename="__SVG__b88556f9393c4d0ddb57e0f7fc2e96a6" height="15.736350000000002" longdesc="__SVG__b88556f9393c4d0ddb57e0f7fc2e96a6" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="106.708875"/></span></span></span></p>
</blockquote>



<pre style="font-family: 'Source Code Pro',monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"># 遍历批次 每批次使用向量化
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">for t=<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>,...<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">.5000</span>:{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    # 使用<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">X</span>^{t} <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Y</span>^{t} 实现 一步 梯度下降
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Forward</span> prop on <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">X</span>^{t}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Z</span>^[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>] = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">W</span>^[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>]<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">X</span>^{t} + b^[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>]
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">A</span>^[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>] = g[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>](<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Z</span>^[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>])
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">A</span>^[l] = g^[l](<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Z</span>^[l])
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Compute</span> cost <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">J</span>^{t}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">Back</span> prop
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    update <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">W</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">B</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">}
</div></code></pre>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="22-理解mini-batch梯度下降法" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.2 理解mini-batch梯度下降法</h3>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="损失表现" style="background: transparent; color: #1980e6; text-decoration: none;"></a>损失表现</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">mini-batch 的成本函数是震荡下降的</p>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="选择mini-batch-size" style="background: transparent; color: #1980e6; text-decoration: none;"></a>选择mini-batch size</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">Tips:</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">将mini-batch size 设置为m : <strong style="font-weight: bold; line-height: 1.6;">Batch Gradient Descend</strong></li>
<li style="line-height: 1.6;">将mini-batch size 设置为1 : <strong style="font-weight: bold; line-height: 1.6;">stochastic gradient descent(随机梯度下降)</strong>   </li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">batch gradient descend</strong>的<em style="line-height: 1.6;">cost</em>轨迹，相对噪声低，幅度大 <br/>
<strong style="font-weight: bold; line-height: 1.6;">stochastic gradient descent</strong>的<em style="line-height: 1.6;">cost</em>轨迹，噪声大，徘徊在最小值 缺点：失去了向量化的加速处理 <br/>
 一般使用合适batch size的mini-batch 其优点：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">向量化</li>
<li style="line-height: 1.6;">不全部使用数据集</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">size 选取：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">样本集小直接使用<strong style="font-weight: bold; line-height: 1.6;">batch gradient descent</strong>  (<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__83f1c2adeabee8a2a95c9f30d6f2fe48" type="image/png" data-filename="__SVG__83f1c2adeabee8a2a95c9f30d6f2fe48" height="14.861350000000002" longdesc="__SVG__83f1c2adeabee8a2a95c9f30d6f2fe48" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="67.3477"/></span></span></span>)</li>
<li style="line-height: 1.6;">mini-batch size 一般为 [64，128，256，512] 一般为2的次方</li>
<li style="line-height: 1.6;">保证<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__879d45f37e540fb7cffa67fc7b7d6535" type="image/png" data-filename="__SVG__879d45f37e540fb7cffa67fc7b7d6535" height="17.48635" longdesc="__SVG__879d45f37e540fb7cffa67fc7b7d6535" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="63.8477"/></span></span></span> 与CPU/GPU内存相适应</li>
</ul>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="23-指数加权平均" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.3 指数加权平均</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">指数加权平均</strong>(exponentially weighted averages)又称<strong style="font-weight: bold; line-height: 1.6;">指数加权移动平均</strong>(exponentially weight moving averages) <br/>
以温度为例, <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7f24a58d918e4f76022ba12e714777ff" type="image/png" data-filename="__SVG__7f24a58d918e4f76022ba12e714777ff" height="14.861350000000002" longdesc="__SVG__7f24a58d918e4f76022ba12e714777ff" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="47.2227"/></span></span></span> <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__45d3c3006cf33081630eb3c8e2b5272f" type="image/png" data-filename="__SVG__45d3c3006cf33081630eb3c8e2b5272f" height="14.861350000000002" longdesc="__SVG__45d3c3006cf33081630eb3c8e2b5272f" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="160.05675"/></span></span></span> <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__b699dc4e2debc037ec33e51773b1f65e" type="image/png" data-filename="__SVG__b699dc4e2debc037ec33e51773b1f65e" height="14.861350000000002" longdesc="__SVG__b699dc4e2debc037ec33e51773b1f65e" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="160.05675"/></span></span></span> <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__0ee8d5a63da470d3b1f0d2b799ba6300" type="image/png" data-filename="__SVG__0ee8d5a63da470d3b1f0d2b799ba6300" height="14.861350000000002" longdesc="__SVG__0ee8d5a63da470d3b1f0d2b799ba6300" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="160.05675"/></span></span></span> <br/>
… <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__12073ae4dd1b215b66481d2c023591de" type="image/png" data-filename="__SVG__12073ae4dd1b215b66481d2c023591de" height="14.861350000000002" longdesc="__SVG__12073ae4dd1b215b66481d2c023591de" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="180.16775"/></span></span></span> <br/>
效果如图：  </p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="02.改善深层神经网络_files/httppa54oihmf.bkt.clouddn.com18-6-2117117533.jpg" type="image/jpeg" data-filename="http://pa54oihmf.bkt.clouddn.com/18-6-21/17117533.jpg" alt="效果图" longdesc="http://pa54oihmf.bkt.clouddn.com/18-6-21/17117533.jpg" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f1f4269377811757132554bb6cc89813" type="image/png" data-filename="__SVG__f1f4269377811757132554bb6cc89813" height="15.736350000000002" longdesc="__SVG__f1f4269377811757132554bb6cc89813" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="155.68175"/></span></span></span> <br/>
当<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__464ee034a9407d651fa1e6480a3c1b98" type="image/png" data-filename="__SVG__464ee034a9407d651fa1e6480a3c1b98" height="25.36135" longdesc="__SVG__464ee034a9407d651fa1e6480a3c1b98" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="282.515625"/></span></span></span> <br/>
当<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__a52c7439156fc1657b64d464a063687e" type="image/png" data-filename="__SVG__a52c7439156fc1657b64d464a063687e" height="25.36135" longdesc="__SVG__a52c7439156fc1657b64d464a063687e" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="291.251625"/></span></span></span> <br/>
当<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__352aaba2cd05f226f2d6f84a81cff430" type="image/png" data-filename="__SVG__352aaba2cd05f226f2d6f84a81cff430" height="25.36135" longdesc="__SVG__352aaba2cd05f226f2d6f84a81cff430" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="273.765625"/></span></span></span> <br/>
对比效果图如下：  </p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="02.改善深层神经网络_files/httppa54oihmf.bkt.clouddn.com18-6-2178183345.jpg" type="image/jpeg" data-filename="http://pa54oihmf.bkt.clouddn.com/18-6-21/78183345.jpg" alt="效果对比图" longdesc="http://pa54oihmf.bkt.clouddn.com/18-6-21/78183345.jpg" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">红色0.9(10天平均温度)  绿色0.98(50天平均温度)  黄色0.5(2天平均温度) <br/>
  平均天数越大图像越平滑，越偏移 <br/>
  平均天数越小噪声越大  </p>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">选定参数对模型有一定的影响</strong></p>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="24-理解指数加权平均" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.4 理解指数加权平均</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__3cbb266ebe0559cf94fe7b129677622c" type="image/png" data-filename="__SVG__3cbb266ebe0559cf94fe7b129677622c" height="15.736350000000002" longdesc="__SVG__3cbb266ebe0559cf94fe7b129677622c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="150.43175"/></span></span></span>  </p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__3bda68961c85064e45888de7de7140dc" type="image/png" data-filename="__SVG__3bda68961c85064e45888de7de7140dc" height="14.861350000000002" longdesc="__SVG__3bda68961c85064e45888de7de7140dc" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="161.80675"/></span></span></span> <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f25e6976393493d18ce68e36989b709d" type="image/png" data-filename="__SVG__f25e6976393493d18ce68e36989b709d" height="14.861350000000002" longdesc="__SVG__f25e6976393493d18ce68e36989b709d" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="150.43175"/></span></span></span> <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__a90c8e278a950b752b76b853519a2534" type="image/png" data-filename="__SVG__a90c8e278a950b752b76b853519a2534" height="14.861350000000002" longdesc="__SVG__a90c8e278a950b752b76b853519a2534" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="150.43175"/></span></span></span> <br/>
… <br/>
<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f1c04bd77a89bcf7da579e066e8d519a" type="image/png" data-filename="__SVG__f1c04bd77a89bcf7da579e066e8d519a" height="18.36135" longdesc="__SVG__f1c04bd77a89bcf7da579e066e8d519a" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="457.447375"/></span></span></span>  </p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"></p><div style="line-height: 1.6;"><div style="max-width: none; position: relative; width: 100%; text-indent: 0; margin: 1em 0; max-height: none; min-width: 0; min-height: 0; line-height: 1.6; text-align: center; display: block;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__43afe4091b14b74e895188168dcc514f" type="image/png" data-filename="__SVG__43afe4091b14b74e895188168dcc514f" height="35.86135" longdesc="__SVG__43afe4091b14b74e895188168dcc514f" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="121.57074999999999"/></span></span></div></div>
<div style="line-height: 1.6;"><div style="max-width: none; position: relative; width: 100%; text-indent: 0; margin: 1em 0; max-height: none; min-width: 0; min-height: 0; line-height: 1.6; text-align: center; display: block;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c922eb11f862cebb4af459577cba6182" type="image/png" data-filename="__SVG__c922eb11f862cebb4af459577cba6182" height="35.86135" longdesc="__SVG__c922eb11f862cebb4af459577cba6182" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="94.458875"/></span></span></div></div>
即，经过10天后，权重下降到原来的三分之一 <br/>
当<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__a30b2eaa24b57e63b150124d418f9232" type="image/png" data-filename="__SVG__a30b2eaa24b57e63b150124d418f9232" height="15.736350000000002" longdesc="__SVG__a30b2eaa24b57e63b150124d418f9232" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="60.3477"/></span></span></span>时，需要指数50能达到<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__00ff0df824690545f5d046410617bfe5" type="image/png" data-filename="__SVG__00ff0df824690545f5d046410617bfe5" height="21.86135" longdesc="__SVG__00ff0df824690545f5d046410617bfe5" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="12.236350000000002"/></span></span></span>，即可以看作是平均了50天温度可以使用<div style="line-height: 1.6;"><div style="max-width: none; position: relative; width: 100%; text-indent: 0; margin: 1em 0; max-height: none; min-width: 0; min-height: 0; line-height: 1.6; text-align: center; display: block;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__37a5bbc454aaefe72c8eb62aaf1e848a" type="image/png" data-filename="__SVG__37a5bbc454aaefe72c8eb62aaf1e848a" height="38.4727" longdesc="__SVG__37a5bbc454aaefe72c8eb62aaf1e848a" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="42.86135"/></span></span></div></div>来表示平均了多少数据(<strong style="font-weight: bold; line-height: 1.6;"><em style="line-height: 1.6;">非正式数学证明</em></strong>)  <p style="margin: 0 0 1.1em; line-height: 1.6;"></p>



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="25-指数加权平均的偏差修正bias-correction" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.5 指数加权平均的偏差修正(bias correction)</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">当<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c9d7adaf70649e6eac596cb7eba2b33e" type="image/png" data-filename="__SVG__c9d7adaf70649e6eac596cb7eba2b33e" height="14.861350000000002" longdesc="__SVG__c9d7adaf70649e6eac596cb7eba2b33e" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="41.9727"/></span></span></span>时，<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__9c6425d484bb46c43238e9966751cd31" type="image/png" data-filename="__SVG__9c6425d484bb46c43238e9966751cd31" height="15.736350000000002" longdesc="__SVG__9c6425d484bb46c43238e9966751cd31" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="233.529625"/></span></span></span>，会发现前期数据值比较小 。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="02.改善深层神经网络_files/httppa54oihmf.bkt.clouddn.com18-6-1263213598.jpg" type="image/jpeg" data-filename="http://pa54oihmf.bkt.clouddn.com/18-6-12/63213598.jpg" alt="偏差修正对比图" longdesc="http://pa54oihmf.bkt.clouddn.com/18-6-12/63213598.jpg" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">紫线是实际图形，对比绿线发现，前期数值偏小，后期重合</p>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">偏差修正</strong><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__800c42607acda3a3a693dd0f69902fac" type="image/png" data-filename="__SVG__800c42607acda3a3a693dd0f69902fac" height="27.98635" longdesc="__SVG__800c42607acda3a3a693dd0f69902fac" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="30.61135"/></span></span></span> 用来解决前期偏差过大问题，随着<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__4f4f4e395762a3af4575de74c019ebb5" type="image/png" data-filename="__SVG__4f4f4e395762a3af4575de74c019ebb5" height="10.486350000000002" longdesc="__SVG__4f4f4e395762a3af4575de74c019ebb5" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="5.2363325"/></span></span></span>的增加，偏差修正无效。 <br/>
在机器学习中，大家都不在乎使用偏差修正，大部分人喜欢熬过前期。如果关心初期的偏差，就需要使用它。</p>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="26-动量梯度下降法momentum" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.6 动量梯度下降法Momentum</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">Momemtum</strong> 在梯度下降中，我们希望朝最优解进向横向速度越大，纵向震荡越小越好。</p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">Momemtum</strong>对于优化碗形状损失函数比较适用</p>
</blockquote>

<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="implementation-details" style="background: transparent; color: #1980e6; text-decoration: none;"></a>Implementation details</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">On iteration t: <br/>
    compute <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__39c6b75b6bbcf2578ccbc6f1f6006a3f" type="image/png" data-filename="__SVG__39c6b75b6bbcf2578ccbc6f1f6006a3f" height="13.111350000000002" longdesc="__SVG__39c6b75b6bbcf2578ccbc6f1f6006a3f" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="24.48635"/></span></span></span>,<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7a855430dfdb94dc9fd07aeba203341c" type="image/png" data-filename="__SVG__7a855430dfdb94dc9fd07aeba203341c" height="13.111350000000002" longdesc="__SVG__7a855430dfdb94dc9fd07aeba203341c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="17.48635"/></span></span></span>, on the current mini-batch <br/>
    <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__2abf396a075ee5168cf401d650897c5d" type="image/png" data-filename="__SVG__2abf396a075ee5168cf401d650897c5d" height="15.736350000000002" longdesc="__SVG__2abf396a075ee5168cf401d650897c5d" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="174.05675"/></span></span></span> <br/>
    <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f5832014ae900fca79b17fe0d9cd7f0c" type="image/png" data-filename="__SVG__f5832014ae900fca79b17fe0d9cd7f0c" height="15.736350000000002" longdesc="__SVG__f5832014ae900fca79b17fe0d9cd7f0c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="167.93175"/></span></span></span> <br/>
    <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__ecf919b2f48286f7dab60a8e08b74184" type="image/png" data-filename="__SVG__ecf919b2f48286f7dab60a8e08b74184" height="14.861350000000002" longdesc="__SVG__ecf919b2f48286f7dab60a8e08b74184" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="202.04275"/></span></span></span> <br/>
Hyperparameters:<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__8b590cf37dd7dcc5776dfa35507b0fbf" type="image/png" data-filename="__SVG__8b590cf37dd7dcc5776dfa35507b0fbf" height="15.736350000000002" longdesc="__SVG__8b590cf37dd7dcc5776dfa35507b0fbf" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="25.36135"/></span></span></span> <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__b81f57e7369896ff3b8d729a1ffec5b4" type="image/png" data-filename="__SVG__b81f57e7369896ff3b8d729a1ffec5b4" height="15.736350000000002" longdesc="__SVG__b81f57e7369896ff3b8d729a1ffec5b4" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="51.5977"/></span></span></span>(平均十次数据) 不使用<strong style="font-weight: bold; line-height: 1.6;">偏差修正</strong></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__39c6b75b6bbcf2578ccbc6f1f6006a3f [1]" type="image/png" data-filename="__SVG__39c6b75b6bbcf2578ccbc6f1f6006a3f" height="13.111350000000002" longdesc="__SVG__39c6b75b6bbcf2578ccbc6f1f6006a3f" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="24.48635"/></span></span></span> <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7a855430dfdb94dc9fd07aeba203341c [1]" type="image/png" data-filename="__SVG__7a855430dfdb94dc9fd07aeba203341c" height="13.111350000000002" longdesc="__SVG__7a855430dfdb94dc9fd07aeba203341c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="17.48635"/></span></span></span> 可以理解为加速度  <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__ee46d51462f66cc600c0690325191d1c" type="image/png" data-filename="__SVG__ee46d51462f66cc600c0690325191d1c" height="11.361350000000002" longdesc="__SVG__ee46d51462f66cc600c0690325191d1c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="55.0977"/></span></span></span> 可以理解为速度 <br/>
  前项<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__029a3477b98537ec1e238e776ce3454b" type="image/png" data-filename="__SVG__029a3477b98537ec1e238e776ce3454b" height="15.736350000000002" longdesc="__SVG__029a3477b98537ec1e238e776ce3454b" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="38.4727"/></span></span></span>可以理解为摩擦力</p>
</blockquote>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">Tip</strong>: 有一些资料中删除了后项的<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__5633469e3a7076faa004beea338940dd" type="image/png" data-filename="__SVG__5633469e3a7076faa004beea338940dd" height="15.736350000000002" longdesc="__SVG__5633469e3a7076faa004beea338940dd" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="48.0977"/></span></span></span>参数， 即<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__836b45cc38b486b84b039c05c5788329" type="image/png" data-filename="__SVG__836b45cc38b486b84b039c05c5788329" height="15.736350000000002" longdesc="__SVG__836b45cc38b486b84b039c05c5788329" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="125.94574999999999"/></span></span></span> <br/>
  得到的<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__bce18807ec2e7d2d9a901905ae8312c1" type="image/png" data-filename="__SVG__bce18807ec2e7d2d9a901905ae8312c1" height="11.361350000000002" longdesc="__SVG__bce18807ec2e7d2d9a901905ae8312c1" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="26.23635"/></span></span></span>缩小了<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__5633469e3a7076faa004beea338940dd [1]" type="image/png" data-filename="__SVG__5633469e3a7076faa004beea338940dd" height="15.736350000000002" longdesc="__SVG__5633469e3a7076faa004beea338940dd" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="48.0977"/></span></span></span>倍 <br/>
  这要求学习率<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c745b9b57c145ec5577b82542b2df546" type="image/png" data-filename="__SVG__c745b9b57c145ec5577b82542b2df546" height="8.7363325" longdesc="__SVG__c745b9b57c145ec5577b82542b2df546" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="9.611350000000002"/></span></span></span>要与<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__5633469e3a7076faa004beea338940dd [2]" type="image/png" data-filename="__SVG__5633469e3a7076faa004beea338940dd" height="15.736350000000002" longdesc="__SVG__5633469e3a7076faa004beea338940dd" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="48.0977"/></span></span></span>相应变化，影响了<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c745b9b57c145ec5577b82542b2df546 [1]" type="image/png" data-filename="__SVG__c745b9b57c145ec5577b82542b2df546" height="8.7363325" longdesc="__SVG__c745b9b57c145ec5577b82542b2df546" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="9.611350000000002"/></span></span></span>的最优值 <br/>
  此外，如果调整<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__8217ed3c32a785f0b5aad4055f432ad8" type="image/png" data-filename="__SVG__8217ed3c32a785f0b5aad4055f432ad8" height="15.736350000000002" longdesc="__SVG__8217ed3c32a785f0b5aad4055f432ad8" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="9.611350000000002"/></span></span></span> 则需要对应调整<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c745b9b57c145ec5577b82542b2df546 [2]" type="image/png" data-filename="__SVG__c745b9b57c145ec5577b82542b2df546" height="8.7363325" longdesc="__SVG__c745b9b57c145ec5577b82542b2df546" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="9.611350000000002"/></span></span></span> 所以不选择此实现方式</p>
</blockquote>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="27-rmsprop" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.7 RMSprop</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">RMSprop(root mean square prop)可以消除梯度下降算法中的摆动，加速梯度下降，可以使用更大学习率    </p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="02.改善深层神经网络_files/httppa54oihmf.bkt.clouddn.com18-6-2136190156.jpg" type="image/jpeg" data-filename="http://pa54oihmf.bkt.clouddn.com/18-6-21/36190156.jpg" alt="RMSprop" longdesc="http://pa54oihmf.bkt.clouddn.com/18-6-21/36190156.jpg" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
我们希望在<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__d08900e5a803e7ac098045df57e5af91" type="image/png" data-filename="__SVG__d08900e5a803e7ac098045df57e5af91" height="12.236350000000002" longdesc="__SVG__d08900e5a803e7ac098045df57e5af91" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="19.23635"/></span></span></span>更新更快，在<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__9b060a1e866be96c33ade2383d9061d3" type="image/png" data-filename="__SVG__9b060a1e866be96c33ade2383d9061d3" height="16.61135" longdesc="__SVG__9b060a1e866be96c33ade2383d9061d3" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="16.61135"/></span></span></span>减小震荡 <br/>
从一个蓝色箭头中可以看出<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__62b8505b5d30e272a3057c58767254a6" type="image/png" data-filename="__SVG__62b8505b5d30e272a3057c58767254a6" height="13.111350000000002" longdesc="__SVG__62b8505b5d30e272a3057c58767254a6" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="20.11135"/></span></span></span>比较大，<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7a855430dfdb94dc9fd07aeba203341c [2]" type="image/png" data-filename="__SVG__7a855430dfdb94dc9fd07aeba203341c" height="13.111350000000002" longdesc="__SVG__7a855430dfdb94dc9fd07aeba203341c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="17.48635"/></span></span></span>比较小(即梯度) <br/>
因此在更新时候加上相关项来处理  </p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__d08900e5a803e7ac098045df57e5af91 [1]" type="image/png" data-filename="__SVG__d08900e5a803e7ac098045df57e5af91" height="12.236350000000002" longdesc="__SVG__d08900e5a803e7ac098045df57e5af91" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="19.23635"/></span></span></span> 和 <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__9b060a1e866be96c33ade2383d9061d3 [1]" type="image/png" data-filename="__SVG__9b060a1e866be96c33ade2383d9061d3" height="16.61135" longdesc="__SVG__9b060a1e866be96c33ade2383d9061d3" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="16.61135"/></span></span></span> 表示高维中的参数 不仅代表w,b</p>
</blockquote>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;">实现：</p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">在迭代<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__4f4f4e395762a3af4575de74c019ebb5 [1]" type="image/png" data-filename="__SVG__4f4f4e395762a3af4575de74c019ebb5" height="10.486350000000002" longdesc="__SVG__4f4f4e395762a3af4575de74c019ebb5" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="5.2363325"/></span></span></span>中 <br/>
  计算 mini-batch 中的<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__62b8505b5d30e272a3057c58767254a6 [1]" type="image/png" data-filename="__SVG__62b8505b5d30e272a3057c58767254a6" height="13.111350000000002" longdesc="__SVG__62b8505b5d30e272a3057c58767254a6" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="20.11135"/></span></span></span>,<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7a855430dfdb94dc9fd07aeba203341c [3]" type="image/png" data-filename="__SVG__7a855430dfdb94dc9fd07aeba203341c" height="13.111350000000002" longdesc="__SVG__7a855430dfdb94dc9fd07aeba203341c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="17.48635"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__4d1b3973aeb9e90c0acce3a6e5cf3ef8" type="image/png" data-filename="__SVG__4d1b3973aeb9e90c0acce3a6e5cf3ef8" height="18.36135" longdesc="__SVG__4d1b3973aeb9e90c0acce3a6e5cf3ef8" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="185.41775"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__39a9404de992511f74191d9e7553d07b" type="image/png" data-filename="__SVG__39a9404de992511f74191d9e7553d07b" height="18.36135" longdesc="__SVG__39a9404de992511f74191d9e7553d07b" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="178.41775"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__448b5f59d3ad1f651852a7fad90b4ca2" type="image/png" data-filename="__SVG__448b5f59d3ad1f651852a7fad90b4ca2" height="30.61135" longdesc="__SVG__448b5f59d3ad1f651852a7fad90b4ca2" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="109.32075"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__6fac32e7ed14ce263007fb6a78495a65" type="image/png" data-filename="__SVG__6fac32e7ed14ce263007fb6a78495a65" height="29.722700000000003" longdesc="__SVG__6fac32e7ed14ce263007fb6a78495a65" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="102.32075"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__c6fe0150a88a56b208d5078616e12cda" type="image/png" data-filename="__SVG__c6fe0150a88a56b208d5078616e12cda" height="18.36135" longdesc="__SVG__c6fe0150a88a56b208d5078616e12cda" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="39.36135"/></span></span></span> 变小 w更新越大  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__64cb10cdbf7704dd2835469147a8dd3c" type="image/png" data-filename="__SVG__64cb10cdbf7704dd2835469147a8dd3c" height="18.36135" longdesc="__SVG__64cb10cdbf7704dd2835469147a8dd3c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="36.7227"/></span></span></span> 变大 b更新越大  <br/>
  特别的为了防止<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__df490175579288fc5762ceda7a54b4ca" type="image/png" data-filename="__SVG__df490175579288fc5762ceda7a54b4ca" height="22.73635" longdesc="__SVG__df490175579288fc5762ceda7a54b4ca" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="40.2227"/></span></span></span>过小，会添加一项<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7ccca27b5ccc533a2dd72dc6fa28ed84" type="image/png" data-filename="__SVG__7ccca27b5ccc533a2dd72dc6fa28ed84" height="8.7363325" longdesc="__SVG__7ccca27b5ccc533a2dd72dc6fa28ed84" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="7.8613325"/></span></span></span> : <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__5da5c6ad5d00fa093bbcdd4c4195dc37" type="image/png" data-filename="__SVG__5da5c6ad5d00fa093bbcdd4c4195dc37" height="30.61135" longdesc="__SVG__5da5c6ad5d00fa093bbcdd4c4195dc37" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="123.32074999999999"/></span></span></span> <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__8de3012819da65de1b5998eae8a644cb" type="image/png" data-filename="__SVG__8de3012819da65de1b5998eae8a644cb" height="29.722700000000003" longdesc="__SVG__8de3012819da65de1b5998eae8a644cb" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="116.32074999999999"/></span></span></span> <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7ccca27b5ccc533a2dd72dc6fa28ed84 [1]" type="image/png" data-filename="__SVG__7ccca27b5ccc533a2dd72dc6fa28ed84" height="8.7363325" longdesc="__SVG__7ccca27b5ccc533a2dd72dc6fa28ed84" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="7.8613325"/></span></span></span>一般取值<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__3638e50463da9c60c05d8519c65d3982" type="image/png" data-filename="__SVG__3638e50463da9c60c05d8519c65d3982" height="16.61135" longdesc="__SVG__3638e50463da9c60c05d8519c65d3982" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="33.2227"/></span></span></span> <br/>
  效果示意图为绿线</p>
</blockquote>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="28-adam-优化算法" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.8 Adam 优化算法</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;">Adam优化算法是把Momentum和RMSprop算法结合在一起 <br/>
算法流程：</p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__2f6369032bde21b2d889dad5f7a3a835" type="image/png" data-filename="__SVG__2f6369032bde21b2d889dad5f7a3a835" height="14.861350000000002" longdesc="__SVG__2f6369032bde21b2d889dad5f7a3a835" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="237.029625"/></span></span></span> <br/>
  在迭代<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__4f4f4e395762a3af4575de74c019ebb5 [2]" type="image/png" data-filename="__SVG__4f4f4e395762a3af4575de74c019ebb5" height="10.486350000000002" longdesc="__SVG__4f4f4e395762a3af4575de74c019ebb5" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="5.2363325"/></span></span></span>： <br/>
  使用mini-batch 计算 <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__62b8505b5d30e272a3057c58767254a6 [2]" type="image/png" data-filename="__SVG__62b8505b5d30e272a3057c58767254a6" height="13.111350000000002" longdesc="__SVG__62b8505b5d30e272a3057c58767254a6" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="20.11135"/></span></span></span>, <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__7a855430dfdb94dc9fd07aeba203341c [4]" type="image/png" data-filename="__SVG__7a855430dfdb94dc9fd07aeba203341c" height="13.111350000000002" longdesc="__SVG__7a855430dfdb94dc9fd07aeba203341c" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="17.48635"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__f0e382cf7d9f923ddc8ff8ba5c661254" type="image/png" data-filename="__SVG__f0e382cf7d9f923ddc8ff8ba5c661254" height="15.736350000000002" longdesc="__SVG__f0e382cf7d9f923ddc8ff8ba5c661254" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="359.4885"/></span></span></span> &lt;- “momentum” <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__15ef3b23ef739e47090fa0825bf9d390" type="image/png" data-filename="__SVG__15ef3b23ef739e47090fa0825bf9d390" height="15.736350000000002" longdesc="__SVG__15ef3b23ef739e47090fa0825bf9d390" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="16.61135"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__694cc32ab608e84ae5145dc8806ee90a" type="image/png" data-filename="__SVG__694cc32ab608e84ae5145dc8806ee90a" height="18.36135" longdesc="__SVG__694cc32ab608e84ae5145dc8806ee90a" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="400.5995"/></span></span></span> &lt;- “RMSprop” <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__2cae3bbfffb6ab2858054ba28bfcba80" type="image/png" data-filename="__SVG__2cae3bbfffb6ab2858054ba28bfcba80" height="15.736350000000002" longdesc="__SVG__2cae3bbfffb6ab2858054ba28bfcba80" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="16.61135"/></span></span></span> <br/>
  # 要进行偏差修正 <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__4acc30d50e1db4e27f9389b3cf300b3d" type="image/png" data-filename="__SVG__4acc30d50e1db4e27f9389b3cf300b3d" height="20.98635" longdesc="__SVG__4acc30d50e1db4e27f9389b3cf300b3d" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="341.9885"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__22a169427b5271d2035c975e875b0984" type="image/png" data-filename="__SVG__22a169427b5271d2035c975e875b0984" height="20.98635" longdesc="__SVG__22a169427b5271d2035c975e875b0984" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="331.501625"/></span></span></span> <br/>
  # 更新系数 <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__613f73c68113cfda08c6b4a6d8a3fa8d" type="image/png" data-filename="__SVG__613f73c68113cfda08c6b4a6d8a3fa8d" height="42.86135" longdesc="__SVG__613f73c68113cfda08c6b4a6d8a3fa8d" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="328.001625"/></span></span></span></p>
</blockquote>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">超参数的选择 <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__deca657aaa36953d92b6986d33a7d194" type="image/png" data-filename="__SVG__deca657aaa36953d92b6986d33a7d194" height="15.736350000000002" longdesc="__SVG__deca657aaa36953d92b6986d33a7d194" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="79.58396250000001"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__553b0d647df8555ad7f090250818eb46" type="image/png" data-filename="__SVG__553b0d647df8555ad7f090250818eb46" height="15.736350000000002" longdesc="__SVG__553b0d647df8555ad7f090250818eb46" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="116.32074999999999"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__3a0715d753aae737ed821fd96a37ec8e" type="image/png" data-filename="__SVG__3a0715d753aae737ed821fd96a37ec8e" height="18.36135" longdesc="__SVG__3a0715d753aae737ed821fd96a37ec8e" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="141.69574999999998"/></span></span></span> <br/>
  <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__dd73d7cb2f0a7a81e46255d5f37c41e3" type="image/png" data-filename="__SVG__dd73d7cb2f0a7a81e46255d5f37c41e3" height="16.61135" longdesc="__SVG__dd73d7cb2f0a7a81e46255d5f37c41e3" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="55.0977"/></span></span></span> <br/>
  一般使用默认就好，不需要特别修改 <br/>
  Adam : Adaption momentum Estimator</p>
</blockquote>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="29-学习率衰减" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.9 学习率衰减</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">epoch</strong>:完整的使用一次全部数据集  </p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__ff92fb9d4a17fd629ea35481e66b4062" type="image/png" data-filename="__SVG__ff92fb9d4a17fd629ea35481e66b4062" height="25.36135" longdesc="__SVG__ff92fb9d4a17fd629ea35481e66b4062" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="167.05675"/></span></span></span></li>
<li style="line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__578b5b52ea25b6504a48e016719a76e8" type="image/png" data-filename="__SVG__578b5b52ea25b6504a48e016719a76e8" height="19.23635" longdesc="__SVG__578b5b52ea25b6504a48e016719a76e8" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="146.93175"/></span></span></span></li>
<li style="line-height: 1.6;"><span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6;"><img src="02.改善深层神经网络_files/__SVG__de479798bd799b92d26d82948138a904" type="image/png" data-filename="__SVG__de479798bd799b92d26d82948138a904" height="29.722700000000003" longdesc="__SVG__de479798bd799b92d26d82948138a904" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" width="132.94574999999998"/></span></span></span></li>
<li style="line-height: 1.6;">离散化衰减</li>
<li style="line-height: 1.6;">手动衰减</li>
</ul>

<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;"><a name="210-局部最优的问题" style="background: transparent; color: #1980e6; text-decoration: none;"></a>2.10 局部最优的问题</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">鞍点(saddle point)</strong>问题：在各维度导数为0，但部分维度是凸函数顶点</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">unlikely to get stuck in a bad local optima(不太可能陷入局部最优的最佳点)</li>
<li style="line-height: 1.6;">Plateaus can make learning slow(平滑区域导致学习变慢，Adam能加速学习逃离)</li>
</ul></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">02.%u6539%u5584%u6DF1%u5C42%u795E%u7ECF%u7F51%u7EDC%0A@%28%u6DF1%u5EA6%u5B66%u4E60_%u5434%u6069%u8FBE%29%5B%u6DF1%u5EA6%u5B66%u4E60%2C%20%u5434%u6069%u8FBE%5D%0A%0A%5BTOC%5D%0A%23%2002.%u6539%u5584%u6DF1%u5C42%u795E%u7ECF%u7F51%u7EDC%0A%23%23%20%u7B2C%u4E00%u5468%0A%0A%23%23%23%201-1%20%u8BAD%u7EC3/%u5F00%u53D1/%u6D4B%u8BD5%u96C6%0A%u4EE5%u524D%u4E00%u822C%u4F7F%u75287%3A3%u5212%u5206%u8BAD%u7EC3%u96C6%u6D4B%u8BD5%u96C6%u62166%3A2%3A2%20%u3002%u5927%u6570%u636E%u4E0B%u901A%u5E38%u9700%u8981%u7528%u9A8C%u8BC1%u96C6%u5FEB%u901F%u9A8C%u8BC1%u591A%u79CD%u7B97%u6CD5%u7684%u4F18%u52A3%uFF0C%u6240%u4EE5%u53EF%u4EE5%u53BB%u5C0F%u4E00%u4E9B%u3002%0A%u767E%u4E07%u6570%u636E%u96C698%uFF1A1%uFF1A1%25%20%20%0A%u786E%u4FDD%u9A8C%u8BC1%u96C6%u5408%u6D4B%u8BD5%u96C6%u7684%u6570%u636E%u6765%u81EA%u540C%u4E00%u5206%u5E03%0A%0A%23%23%23%201-2%20%u504F%u5DEE/%u65B9%u5DEE%0A%u6B20%u62DF%u5408%uFF1A%u504F%u5DEE%u8FC7%u9AD8%20%20%u8FC7%u62DF%u5408%uFF1A%u65B9%u5DEE%u8FC7%u9AD8%0A%u9AD8%u65B9%u5DEE%uFF1A%u8BAD%u7EC3%u96C6%u548C%u9A8C%u8BC1%u96C6%u7684%u9519%u8BEF%u7387%u76F8%u5DEE%u8FC7%u5927%20%0A%u9AD8%u504F%u5DEE%uFF1A%u4E0E%u4EBA%u7C7B%u7B49%u5B9E%u9645%u5206%u7C7B%u6548%u679C%u5BF9%u6BD4%u592A%u5DEE%0A%u5982%u679C%u53EF%u4EE5%u786E%u5B9A%u6700%u4F18%u65B9%u5DEE%20%u7136%u540E%u53BB%u548C%u504F%u5DEE%u65B9%u5DEE%u4F5C%u6BD4%u8F83%u6765%u8BC4%u4EF7%u6A21%u578B%0A%0A%23%23%23%201-3%20%u673A%u5668%u5B66%u4E60%u57FA%u7840%0AHigh%20bias%3F%20%0A-%20Bigger%20network%0A-%20Train%20longer%20%0A-%20NN%20architecture%20search%20%28%u53EF%u9009%29%0A%u62DF%u5408%u8BAD%u7EC3%u96C6%u540E%uFF0C%u518D%u770B%20High%20variance%3F%0A-%20More%20data%0A-%20regularization%0A-%20NN%20architecture%20search%20%28%u53EF%u9009%29%0A%0A%23%23%23%201-4%20%u6B63%u5219%u5316%0AL1%20%u6B63%u5219%u5316%20%24%5Comega%24%u7A00%u758F%uFF0C%u4F46%u6CA1%u6709%u538B%u7F29%u6A21%u578B%u51CF%u5C11%u5185%u5B58%0AL2%20%u6B63%u5219%u5316%u53C8%u79F0**%u6743%u91CD%u8870%u51CF%28Weight%20Decay%29**%20%u516C%u5F0F%u53EF%u89C1%u6743%u91CD%u5728%u51CF%u5C0F%0A%0A%23%23%23%201-5%20%u4E3A%u4EC0%u4E48%u6B63%u5219%u5316%u53EF%u4EE5%u51CF%u5C11%u8FC7%u62DF%u5408%0AL2%20%u6B63%u5219%u5316%u9632%u6B62%u8FC7%u62DF%u5408%20%u76F4%u89C2%u7ECF%u9A8C%u662F%u6743%u91CD%u8D8A%u591A%u63A5%u8FD1%u4E8E0%20%u6A21%u578B%u8D8A%u7B80%u5355%28%u5B58%u7591%29%0A%u4EE5%60Sigmoid%60%u4E3A%u4F8B%20%u5F53%u6743%u91CD%u8FC7%u5C0F%u65F6%u5019%uFF0C%60Sigmoid%60%u662F%u63A5%u8FD1%u7EBF%u6027%u7684%uFF0C%u6574%u4E2A%u7F51%u7EDC%u662F%u7EBF%u6027%u7684%u4ECE%u800C%u4F7F%u6A21%u578B%u53D8%u4E3A%u7B80%u5355%u6765%u51CF%u5C11%u8FC7%u62DF%u5408%0A%0A%23%23%23%201-6%20Dropout%28Inverted%20dropout%29%0A%60d3%20%3D%20np.random.rand%28a3.shape%5B0%5D%2C%20a3.shape%5B1%5D%29%20%3C%20keep_prob%60%0A%60a3%20/%3D%20keep_prob%60%0A%u4EE5**Hinton**%u8BBA%u6587%u4E2D%u63D0%u51FA%u7684*Dropout*%u5728%u6D4B%u8BD5%u96C6%u4E0A%u662F%u5C06%u6982%u7387%24p%24%u5E94%u7528%u5230%u795E%u7ECF%u5143%u7684%u8F93%u51FA%u8FB9%u4E0A%0A%u4E3A%u4E86%u7B80%u5316%u6D4B%u8BD5%u96C6%u7684%u64CD%u4F5C%uFF0C%u5728%u8BAD%u7EC3%u65F6%u5019%u6BCF%u4E2A%u795E%u7ECF%u5143%u7684%u8F93%u51FA%u90FD%u964D%u4F4E%u4E3A%u6743%u91CD%241/p%24%20%u8FD9%u6837%u5C31%u4E0D%u9700%u8981%u5728%u6D4B%u8BD5%u96C6%u505A%u989D%u5916%u64CD%u4F5C%0A%0A%23%23%23%201-7%20%u7406%u89E3Fropout%0ADropout%20%u6709%u6548%u6027%u4F53%u73B0%uFF1A%0A1.%20%u7B49%u6548%u6B63%u5219%u5316%uFF0C%u4F7F%u7F51%u7EDC%u66F4%u7B80%u5355%0A2.%20%u795E%u7ECF%u5143%u4E0D%u5728%u5B8C%u5168%u4F9D%u8D56%u7279%u5B9A%u7684%u8F93%u5165%u795E%u7ECF%u5143%20%20%0A%0A%u53EF%u4EE5%u8BBE%u7F6E%u4E0D%u540C%u5C42%24%5Comega%24%u7684dropout%20rate%20%20%u8BBE%u7F6E%u4E3A1%u8868%u793A%u4E0D%u4F7F%u7528dropout%0A*Dropout*%u4E3B%u8981%u540C%u4E8E%u8BA1%u7B97%u673A%u89C6%u89C9%28CV%29%uFF0C%u5F53%u8FC7%u62DF%u5408%u7684%u65F6%u5019%u53EF%u4EE5%u5728%u4F7F%u7528%0A%u7F3A%u70B9%uFF1A%0A-%20%u635F%u5931%u51FD%u6570%u7684%u5B9A%u4E49%u4E0D%u5BF9%u660E%u786E%0A-%20%u8C03%u8BD5%u56F0%u96BE%28%u5148%u56FA%u5B9A%u4E3A1%uFF0C%20J%u9012%u51CF%u518D%u5F00%u542F%29%0A%0A%23%23%23%201-8%20%u5176%u4ED6%u6B63%u5219%u5316%u6280%u672F%0A1.%20Data%20Augmentation%20%u6570%u636E%u589E%u5F3A%20%u5982%20%u56FE%u7247%u65CB%u8F6C%u3001%u88C1%u526A%u3001%u626D%u66F2%0A2.%20early%20stooping%20have%20a%20mid-size%20rate%20%24%7C%7CW%7C%7C_%7B2F%7D%24%0A%u901A%u5E38%u7684%u8BAD%u7EC3%u6B65%u9AA4%uFF1A%0A%20%201.%20%u4F18%u5316%u4EE3%u4EF7%u51FD%u6570J%28GD/%20Momentum/%20RMRprop%20/Adam%29%0A%20%202.%20%u907F%u514D%u8FC7%u62DF%u5408%28%u6B63%u5219%u5316%29%20%7C%20%u51CF%u5C11%u65B9%u5DEE%28%u6B63%u4EA4%u5316%29%0Aearly%20stooping%20%u4E0D%u80FD%u72EC%u7ACB%u5904%u7406%u95EE%u98981%202%0A%0A%23%23%23%201-9%20%u6B63%u5219%u5316%u8F93%u5165%20Normalization%20training%20sets%0A0%u5747%u503C%201%u65B9%u5DEE%0A%u5F53%u7279%u5F81%u8303%u56F4%u4E0D%u4E00%u81F4%u65F6%u5019%u4F7F%u7528%u5F52%u4E00%u5316%uFF0C%u52A0%u901F%24J%24%u4E0B%u964D%0A%0A%23%23%23%201-10%20%u68AF%u5EA6%u6D88%u5931%u548C%u7206%u70B8%0A%0A%23%23%23%201-11%20%u795E%u7ECF%u7F51%u7EDC%u7684%u6743%u91CD%u521D%u59CB%u5316%0A%24z%20%3D%20W_1x_1+W_2x_2+...+W_nx_n%24%20%0A%u8BBE%u7F6E%24var%28Wi%29%20%3D%201/n%20W%5E%7B%5Bl%5D%7D%20%24%3D%60np.random.rand%28shape%29*np.sqrt%281/n%5Bl-1%5D%29%60%0A%u6700%u540E%u4E00%u9879%0A*tanh*%20%u4F7F%u7528*Xavier%20*%u521D%u59CB%u5316%uFF0C*ReLU*%u4F7F%u7528%u516C%u5F0F2%0A%3E%20Xavier%20%u521D%u59CB%u5316%uFF0C%u516C%u5F0F%uFF1A%20%24%5Csqrt%7B%5Cfrac%7B1%7D%7Bn%5E%7B%5Bl-1%5D%7D%7D%7D%24%0A%3E%20%u516C%u5F0F%uFF1A%20%24%5Csqrt%7B%5Cfrac%7B2%7D%7Bn%5E%7B%5Bl-1%5D%7D+n%5E%7B%5Bi%5D%7D%7D%7D%24%0A%0A%u6B64%u8D85%u53C2%u6570%u7684%u8C03%u8282%u4F18%u5148%u7B49%u7EA7%u6BD4%u8F83%u4F4E%0A%0A%23%23%23%201-12%20%u68AF%u5EA6%u7684%u6570%u503C%u903C%u8FD1%0A**%u53CC%u8FB9%u8BEF%u5DEE%u6CD5**%uFF1A%24f%28%5Ctheta%29%20%3D%20%5Cfrac%7Bf%28%5Ctheta+%5Cepsilon%29%20-%20f%28%5Ctheta-%5Cepsilon%29%7D%7B2%5Cepsilon%7D%24%0A%0A%23%23%23%201-13%20%u68AF%u5EA6%u68C0%u9A8C%0A%24J%28%5Ctheta%29%20-%3E%20d%5Ctheta%24%0A%2410%5E%7B-7%7D%24%20%u6548%u679Cgreat%20%2410%5E-3%24%u6548%u679Cwrong%0A%21%5BAlt%20text%5D%28./1528095126219.png%29%0A%0A%23%23%23%201-14%20%u68AF%u5EA6%u68C0%u9A8C%u7ECF%u9A8C%0A1.%20Dont%20use%20in%20training%20-%20only%20to%20debug%20%20%20%20%20%20%0A2.%20If%20algorithm%20fails%20grad%20check%2C%20look%20at%20components%20to%20try%20to%20identify%20bug%0A3.%20Rember%20regularization%0A4.%20Doesn%27t%20work%20with%20dropout%0A5.%20Run%20ai%20random%20initialization%3Bperhaps%20again%20after%20some%20training%0A%0A%23%23%23%20%u7B2C%u4E00%u5468%u7B2C%u4E00%u6B21%u4F5C%u4E1A%0A%u6743%u91CD%u521D%u59CB%u5316%u4F5C%u7528%uFF1A%0A+%20%u52A0%u901F%u68AF%u5EA6%u6536%u655B%20%0A+%20%u589E%u52A0%u6CDB%u5316%u80FD%u529B%0A%0A%u6743%u91CD%u521D%u59CB%u5316%u5BF9%u6BD4%0A+%200%20%0A+%20%u968F%u673A%20%0A+%20HE%u4E09%u79CD%u65B9%u5F0F%20%0A%u7ED3%u679C%u9010%u6E10%u53D8%u597D%20%u5176%u4E2D*He%20Initialization*%20%28%5BXavier%20Initialization%u53D8%u79CD%20%u53C2%u8003%5D%28https%3A//www.leiphone.com/news/201703/3qMp45aQtbxTdzmK.html%29%29%0A%0A%u6743%u91CD%u4E3A0%20%24cost%24%u4E0D%u4E0B%u964D%u6A21%u578B%u65E0%u6548%0A%u6743%u91CD%u8FC7%u5927%uFF0C%u6CA1%u6709%u6548%u679C%0A%23%23%23%20%u7B2C%u4E00%u5468%u7B2C%u4E8C%u6B21%u4F5C%u4E1A%0A%u6B63%u5219%u5316%u6280%u672F%u5F88%u6709%u6548%0A%0A%23%23%23%20%u7B2C%u4E00%u5468%u7B2C%u4E09%u6B21%u4F5C%u4E1A%0A%u68AF%u5EA6%u68C0%u9A8C%uFF1A%0A%24%24difference%20%3D%20%5Cfrac%20%7B%5C%7C%20grad%20-%20gradapprox%20%5C%7C_2%7D%7B%5C%7C%20grad%20%5C%7C_2%20+%20%5C%7C%20gradapprox%20%5C%7C_2%20%7D%20%5Ctag%7B3%7D%24%24%0A%0A%23%23%20%u7B2C%u4E8C%u5468%0A%0A%23%23%23%202.1%20Mini-batch%u68AF%u5EA6%u4E0B%u964D%u6CD5%0A%u9ED8%u8BA4%u68AF%u5EA6%u4E0B%u964D%u662F%u5C06%u6240%u6709%u6570%u636E%u8FDB%u884C%u8BA1%u7B97%u5B9E%u73B0%u4E00%u90E8%u68AF%u5EA6%u4E0B%u964D%0A%u5206%u6279%u6B21%20%3A%20%24X%20%3D%20%5C%7BX%5E%7B%5C%7B1%5C%7D%7D%2C%20X%5E%7B%5C%7B1%5C%7D%7D%2C%20...%2C%20X%5E%7B%5C%7Bm%5C%7D%7D%20%5C%7D%24%20%20%0A%u540C%u6837%uFF1A%24Y%20%3D%20%5C%7BY%5E%7B%5C%7B1%5C%7D%7D%2C%20Y%5E%7B%5C%7B1%5C%7D%7D%2C%20...%2C%20Y%5E%7B%5C%7Bm%5C%7D%7D%20%5C%7D%24%20%20%0Amini%20%20batch%20%24t%3AX%5E%7B%5C%7Bt%5C%7D%7D%2C%20Y%5E%7B%5C%7Bt%5C%7D%7D%24%20%20%0A%3E%20%24x%5E%7B%28i%29%7D%24%u8868%u793A%u8BAD%u7EC3%u96C6%u4E2D%u7B2C%24i%24%u4E2A%u8BAD%u7EC3%u6837%u672C%20%20%0A%3E%20%24z%5E%7B%5Bl%5D%7D%24%u8868%u793A%u795E%u7ECF%u7F51%u7EDC%u7684%u5C42%u6570%20%20%20%0A%3E%20%24X%5E%7B%5C%7Bi%5C%7D%7D%20%5C%20%20Y%5E%7B%5C%7Bi%5C%7D%7D%24%u8868%u793A%u4E0D%u540C%u7684mini%20batch%20%20%24X%24%u7EF4%u5EA6%24%28n_x%2C%20%20batch%5C_size%29%24%0A%0A%60%60%60%0A%23%20%u904D%u5386%u6279%u6B21%20%u6BCF%u6279%u6B21%u4F7F%u7528%u5411%u91CF%u5316%0Afor%20t%3D1%2C....5000%3A%7B%0A%09%23%20%u4F7F%u7528X%5E%7Bt%7D%20Y%5E%7Bt%7D%20%u5B9E%u73B0%20%u4E00%u6B65%20%u68AF%u5EA6%u4E0B%u964D%0A%09Forward%20prop%20on%20X%5E%7Bt%7D%0A%09Z%5E%5B1%5D%20%3D%20W%5E%5B1%5DX%5E%7Bt%7D%20+%20b%5E%5B1%5D%0A%09A%5E%5B1%5D%20%3D%20g%5B1%5D%28Z%5E%5B1%5D%29%0A%09.%0A%09.%0A%09.%0A%09A%5E%5Bl%5D%20%3D%20g%5E%5Bl%5D%28Z%5E%5Bl%5D%29%0A%09Compute%20cost%20J%5E%7Bt%7D%0A%09Back%20prop%0A%09update%20W%2CB%0A%7D%0A%60%60%60%0A%0A%23%23%23%202.2%20%u7406%u89E3mini-batch%u68AF%u5EA6%u4E0B%u964D%u6CD5%0A%23%23%23%23%20%u635F%u5931%u8868%u73B0%0Amini-batch%20%u7684%u6210%u672C%u51FD%u6570%u662F%u9707%u8361%u4E0B%u964D%u7684%0A%23%23%23%23%20%u9009%u62E9mini-batch%20size%0ATips%3A%0A-%20%u5C06mini-batch%20size%20%u8BBE%u7F6E%u4E3Am%20%3A%20**Batch%20Gradient%20Descend**%0A-%20%u5C06mini-batch%20size%20%u8BBE%u7F6E%u4E3A1%20%3A%20**stochastic%20gradient%20descent%28%u968F%u673A%u68AF%u5EA6%u4E0B%u964D%29**%20%20%20%0A%0A%0A**batch%20gradient%20descend**%u7684*cost*%u8F68%u8FF9%uFF0C%u76F8%u5BF9%u566A%u58F0%u4F4E%uFF0C%u5E45%u5EA6%u5927%20%20%0A**stochastic%20gradient%20descent**%u7684*cost*%u8F68%u8FF9%uFF0C%u566A%u58F0%u5927%uFF0C%u5F98%u5F8A%u5728%u6700%u5C0F%u503C%20%u7F3A%u70B9%uFF1A%u5931%u53BB%u4E86%u5411%u91CF%u5316%u7684%u52A0%u901F%u5904%u7406%20%20%0A%20%u4E00%u822C%u4F7F%u7528%u5408%u9002batch%20size%u7684mini-batch%20%u5176%u4F18%u70B9%uFF1A%0A%20-%20%u5411%u91CF%u5316%0A%20-%20%u4E0D%u5168%u90E8%u4F7F%u7528%u6570%u636E%u96C6%0A%20%0Asize%20%u9009%u53D6%uFF1A%0A-%20%u6837%u672C%u96C6%u5C0F%u76F4%u63A5%u4F7F%u7528**batch%20gradient%20descent**%20%20%28%24m%5Cleqslant%202000%24%29%0A-%20mini-batch%20size%20%u4E00%u822C%u4E3A%20%5B64%uFF0C128%uFF0C256%uFF0C512%5D%20%u4E00%u822C%u4E3A2%u7684%u6B21%u65B9%0A-%20%u4FDD%u8BC1%24X%5E%7B%5C%7Bt%5C%7D%7D%2C%20Y%5E%7B%5C%7Bt%5C%7D%7D%24%20%u4E0ECPU/GPU%u5185%u5B58%u76F8%u9002%u5E94%0A%0A%23%23%23%202.3%20%u6307%u6570%u52A0%u6743%u5E73%u5747%0A**%u6307%u6570%u52A0%u6743%u5E73%u5747**%28exponentially%20weighted%20averages%29%u53C8%u79F0**%u6307%u6570%u52A0%u6743%u79FB%u52A8%u5E73%u5747**%28exponentially%20weight%20moving%20averages%29%20%20%0A%u4EE5%u6E29%u5EA6%u4E3A%u4F8B%2C%0A%24V_0%20%3D%200%24%20%20%0A%24V_1%20%3D%200.9%20%5Ccdot%20V_0%20+%200.1%20%5Ccdot%20%5Ctheta_1%24%20%20%0A%24V_2%20%3D%200.9%20%5Ccdot%20V_1%20+%200.1%20%5Ccdot%20%5Ctheta_2%24%20%20%0A%24V_3%20%3D%200.9%20%5Ccdot%20V_2%20+%200.1%20%5Ccdot%20%5Ctheta_3%24%20%20%0A...%20%20%0A%24V_t%20%3D%200.9%20%5Ccdot%20V_t-1%20+%200.1%20%5Ccdot%20%5Ctheta_t%24%0A%u6548%u679C%u5982%u56FE%uFF1A%20%20%0A%21%5B%u6548%u679C%u56FE%5D%28http%3A//pa54oihmf.bkt.clouddn.com/18-6-21/17117533.jpg%29%0A%0A%24V_t%20%3D%20%5Cbeta%20V_%7Bt-1%7D%20+%20%281-%5Cbeta%29%20%5Ctheta_t%24%20%20%0A%u5F53%24%5Cbeta%20%3D%200.9%20%uFF1A%5Capprox%20%5Cfrac%7B1%7D%7B1-%5Cbeta%7D%20%3D%2010%5C%20%28dayTemperature%29%24%20%20%0A%u5F53%24%5Cbeta%20%3D%200.98%20%uFF1A%5Capprox%20%5Cfrac%7B1%7D%7B1-%5Cbeta%7D%20%3D%2050%5C%20%28dayTemperature%29%24%20%20%0A%u5F53%24%5Cbeta%20%3D%200.5%20%uFF1A%5Capprox%20%5Cfrac%7B1%7D%7B1-%5Cbeta%7D%20%3D%202%5C%20%28dayTemperature%29%24%20%20%0A%u5BF9%u6BD4%u6548%u679C%u56FE%u5982%u4E0B%uFF1A%20%20%0A%21%5B%u6548%u679C%u5BF9%u6BD4%u56FE%5D%28http%3A//pa54oihmf.bkt.clouddn.com/18-6-21/78183345.jpg%29%0A%3E%20%u7EA2%u82720.9%2810%u5929%u5E73%u5747%u6E29%u5EA6%29%20%20%u7EFF%u82720.98%2850%u5929%u5E73%u5747%u6E29%u5EA6%29%20%20%u9EC4%u82720.5%282%u5929%u5E73%u5747%u6E29%u5EA6%29%0A%3E%20%u5E73%u5747%u5929%u6570%u8D8A%u5927%u56FE%u50CF%u8D8A%u5E73%u6ED1%uFF0C%u8D8A%u504F%u79FB%20%20%0A%3E%20%u5E73%u5747%u5929%u6570%u8D8A%u5C0F%u566A%u58F0%u8D8A%u5927%20%20%0A%0A**%u9009%u5B9A%u53C2%u6570%u5BF9%u6A21%u578B%u6709%u4E00%u5B9A%u7684%u5F71%u54CD**%0A%0A%23%23%23%202.4%20%u7406%u89E3%u6307%u6570%u52A0%u6743%u5E73%u5747%0A%20%20%24v_t%20%3D%20%5Cbeta%20v_%7Bt-1%7D+%281-%5Cbeta%29%5Ctheta_t%24%20%20%0A%20%20%20%20%20%0A%24V_%7B100%7D%20%3D%200.9v_%7B99%7D+0.1%5Ctheta_%7B100%7D%24%20%20%0A%24V_%7B99%7D%20%3D%200.9v_%7B98%7D+0.1%5Ctheta_%7B99%7D%24%20%20%0A%24V_%7B98%7D%20%3D%200.9v_%7B97%7D+0.1%5Ctheta_%7B98%7D%24%20%20%0A...%20%20%0A%24V_%7B100%7D%3D0.1%5Ccdot%5Ctheta_%7B100%7D+0.1%5Ccdot0.9%5Ctheta_%7B99%7D+0.1%5Ccdot%280.9%29%5E2%5Ctheta_%7B98%7D+0.1%5Ccdot%20%280.9%29%5E3%5Ctheta_%7B97%7D...%24%20%20%0A%0A%24%240.9%5E%7B10%7D%20%5Capprox%200.35%20%5Capprox%20%5Cfrac%7B1%7D%7Be%7D%20%5Clabel%7B1%7D%24%24%0A%24%24%281-%5Cepsilon%29%5E%7B%5Cfrac%7B1%7D%7B%5Cepsilon%7D%7D%20%5Capprox%20%5Cfrac%7B1%7D%7Be%7D%24%24%0A%u5373%uFF0C%u7ECF%u8FC710%u5929%u540E%uFF0C%u6743%u91CD%u4E0B%u964D%u5230%u539F%u6765%u7684%u4E09%u5206%u4E4B%u4E00%0A%u5F53%24%5Cbeta%20%3D%200.98%24%u65F6%uFF0C%u9700%u8981%u6307%u657050%u80FD%u8FBE%u5230%24%5Cfrac%7B1%7D%7B%5Cepsilon%7D%24%uFF0C%u5373%u53EF%u4EE5%u770B%u4F5C%u662F%u5E73%u5747%u4E8650%u5929%u6E29%u5EA6%u53EF%u4EE5%u4F7F%u7528%24%24%5Cfrac%7B1%7D%7B1-%5Cbeta%7D%24%24%u6765%u8868%u793A%u5E73%u5747%u4E86%u591A%u5C11%u6570%u636E%28***%u975E%u6B63%u5F0F%u6570%u5B66%u8BC1%u660E***%29%20%20%0A%0A%23%23%23%202.5%20%u6307%u6570%u52A0%u6743%u5E73%u5747%u7684%u504F%u5DEE%u4FEE%u6B63%28bias%20correction%29%0A%u5F53%24t_0%20%3D%200%24%u65F6%uFF0C%24V_1%20%3D%20%5Cbeta%20V_0+%281-%5Cbeta%20%29%5Ctheta_1%20%3D%20%281-%5Cbeta%20%29%5Ctheta_1%24%uFF0C%u4F1A%u53D1%u73B0%u524D%u671F%u6570%u636E%u503C%u6BD4%u8F83%u5C0F%20%u3002%0A%21%5B%u504F%u5DEE%u4FEE%u6B63%u5BF9%u6BD4%u56FE%5D%28http%3A//pa54oihmf.bkt.clouddn.com/18-6-12/63213598.jpg%29%0A%3E%20%u7D2B%u7EBF%u662F%u5B9E%u9645%u56FE%u5F62%uFF0C%u5BF9%u6BD4%u7EFF%u7EBF%u53D1%u73B0%uFF0C%u524D%u671F%u6570%u503C%u504F%u5C0F%uFF0C%u540E%u671F%u91CD%u5408%0A%0A**%u504F%u5DEE%u4FEE%u6B63**%24%5Cfrac%7BV_t%7D%7B1-%5Cbeta%5Et%7D%24%20%u7528%u6765%u89E3%u51B3%u524D%u671F%u504F%u5DEE%u8FC7%u5927%u95EE%u9898%uFF0C%u968F%u7740%24t%24%u7684%u589E%u52A0%uFF0C%u504F%u5DEE%u4FEE%u6B63%u65E0%u6548%u3002%0A%u5728%u673A%u5668%u5B66%u4E60%u4E2D%uFF0C%u5927%u5BB6%u90FD%u4E0D%u5728%u4E4E%u4F7F%u7528%u504F%u5DEE%u4FEE%u6B63%uFF0C%u5927%u90E8%u5206%u4EBA%u559C%u6B22%u71AC%u8FC7%u524D%u671F%u3002%u5982%u679C%u5173%u5FC3%u521D%u671F%u7684%u504F%u5DEE%uFF0C%u5C31%u9700%u8981%u4F7F%u7528%u5B83%u3002%0A%0A%23%23%23%202.6%20%u52A8%u91CF%u68AF%u5EA6%u4E0B%u964D%u6CD5Momentum%0A**Momemtum**%20%u5728%u68AF%u5EA6%u4E0B%u964D%u4E2D%uFF0C%u6211%u4EEC%u5E0C%u671B%u671D%u6700%u4F18%u89E3%u8FDB%u5411%u6A2A%u5411%u901F%u5EA6%u8D8A%u5927%uFF0C%u7EB5%u5411%u9707%u8361%u8D8A%u5C0F%u8D8A%u597D%u3002%0A%3E%20**Momemtum**%u5BF9%u4E8E%u4F18%u5316%u7897%u5F62%u72B6%u635F%u5931%u51FD%u6570%u6BD4%u8F83%u9002%u7528%0A%0A%23%23%23%23%20Implementation%20details%0AOn%20iteration%20t%3A%0A%20%20%20%20compute%20%24dW%24%2C%24db%24%2C%20on%20the%20current%20mini-batch%20%20%0A%20%20%20%20%24v_%7BdW%7D%20%3D%20%5Cbeta%20v_%7BdW%7D+%281-%5Cbeta%29dW%24%20%20%0A%20%20%20%20%24v_%7Bdb%7D%20%3D%20%5Cbeta%20v_%7BdWb%7D+%281-%5Cbeta%29db%24%20%20%0A%20%20%20%20%24W%20%3D%20W%20-%5Calpha%20v_%7BdW%7D%2C%20b%3Db-%5Calpha%20v_%7Bdb%7D%24%0AHyperparameters%3A%24%5Calpha%20%2C%5Cbeta%24%20%24%5Cbeta%20%3D%200.9%24%28%u5E73%u5747%u5341%u6B21%u6570%u636E%29%20%u4E0D%u4F7F%u7528**%u504F%u5DEE%u4FEE%u6B63**%0A%3E%20%24dW%24%20%24db%24%20%u53EF%u4EE5%u7406%u89E3%u4E3A%u52A0%u901F%u5EA6%20%0A%3E%20%24v_%7BdW%7D%2C%20v_%7Bdb%7D%24%20%u53EF%u4EE5%u7406%u89E3%u4E3A%u901F%u5EA6%0A%3E%20%u524D%u9879%24%5Cbeta%20%3C%201%24%u53EF%u4EE5%u7406%u89E3%u4E3A%u6469%u64E6%u529B%0A%0A----------------%0A%3E%20**Tip**%3A%20%u6709%u4E00%u4E9B%u8D44%u6599%u4E2D%u5220%u9664%u4E86%u540E%u9879%u7684%24%281-%5Cbeta%29%24%u53C2%u6570%uFF0C%20%u5373%24v_%7BdW%7D%20%3D%20%5Cbeta%20v_%7BdW%7D+dW%24%0A%3E%20%u5F97%u5230%u7684%24v_%7BdW%7D%24%u7F29%u5C0F%u4E86%24%281-%5Cbeta%29%24%u500D%0A%3E%20%u8FD9%u8981%u6C42%u5B66%u4E60%u7387%24%5Calpha%24%u8981%u4E0E%24%281-%5Cbeta%29%24%u76F8%u5E94%u53D8%u5316%uFF0C%u5F71%u54CD%u4E86%24%5Calpha%24%u7684%u6700%u4F18%u503C%0A%3E%20%u6B64%u5916%uFF0C%u5982%u679C%u8C03%u6574%24%5Cbeta%24%20%u5219%u9700%u8981%u5BF9%u5E94%u8C03%u6574%24%5Calpha%24%20%u6240%u4EE5%u4E0D%u9009%u62E9%u6B64%u5B9E%u73B0%u65B9%u5F0F%0A%0A%23%23%23%202.7%20RMSprop%0ARMSprop%28root%20mean%20square%20prop%29%u53EF%u4EE5%u6D88%u9664%u68AF%u5EA6%u4E0B%u964D%u7B97%u6CD5%u4E2D%u7684%u6446%u52A8%uFF0C%u52A0%u901F%u68AF%u5EA6%u4E0B%u964D%uFF0C%u53EF%u4EE5%u4F7F%u7528%u66F4%u5927%u5B66%u4E60%u7387%20%20%20%20%0A%21%5BRMSprop%5D%28http%3A//pa54oihmf.bkt.clouddn.com/18-6-21/36190156.jpg%29%0A%u6211%u4EEC%u5E0C%u671B%u5728%24w_%7B%5C_%7D%24%u66F4%u65B0%u66F4%u5FEB%uFF0C%u5728%24b_%7B%5C_%7D%24%u51CF%u5C0F%u9707%u8361%20%20%0A%u4ECE%u4E00%u4E2A%u84DD%u8272%u7BAD%u5934%u4E2D%u53EF%u4EE5%u770B%u51FA%24dw%24%u6BD4%u8F83%u5927%uFF0C%24db%24%u6BD4%u8F83%u5C0F%28%u5373%u68AF%u5EA6%29%20%20%0A%u56E0%u6B64%u5728%u66F4%u65B0%u65F6%u5019%u52A0%u4E0A%u76F8%u5173%u9879%u6765%u5904%u7406%20%20%0A%0A%3E%20%24w_%7B%5C_%7D%24%20%u548C%20%24b_%7B%5C_%7D%24%20%u8868%u793A%u9AD8%u7EF4%u4E2D%u7684%u53C2%u6570%20%u4E0D%u4EC5%u4EE3%u8868w%2Cb%0A%0A------------%0A%u5B9E%u73B0%uFF1A%0A%3E%20%u5728%u8FED%u4EE3%24t%24%u4E2D%20%20%0A%3E%20%u8BA1%u7B97%20mini-batch%20%u4E2D%u7684%24dw%24%2C%24db%24%0A%3E%20%24S_%7Bdw%7D%20%3D%20%5Cbeta%20S_%7Bdw%7D%20+%20%281-%5Cbeta%29%28dw%29%5E2%24%0A%3E%20%24S_%7Bdb%7D%20%3D%20%5Cbeta%20S_%7Bdb%7D%20+%281-%5Cbeta%29%28db%29%5E2%24%0A%3E%20%24w%20%3D%20w-%5Calpha%20%5Cfrac%7Bdw%7D%7B%5Csqrt%7BS_%7Bdw%7D%7D%7D%24%0A%3E%20%24b%20%3D%20b-%20%5Calpha%20%5Cfrac%7Bdb%7D%7B%5Csqrt%7BS_%7Bdb%7D%7D%7D%24%0A%3E%20%24%28dw%29%5E2%24%20%u53D8%u5C0F%20w%u66F4%u65B0%u8D8A%u5927%20%20%24%28db%29%5E2%24%20%u53D8%u5927%20b%u66F4%u65B0%u8D8A%u5927%20%0A%3E%20%u7279%u522B%u7684%u4E3A%u4E86%u9632%u6B62%24%5Csqrt%7BS_%7Bdw%7D%7D%24%u8FC7%u5C0F%uFF0C%u4F1A%u6DFB%u52A0%u4E00%u9879%24%5Cepsilon%24%20%3A%20%24w%20%3D%20w-%5Calpha%20%5Cfrac%7Bdw%7D%7B%5Csqrt%7BS_%7Bdw%7D+%5Cepsilon%7D%7D%24%20%24b%20%3D%20b-%20%5Calpha%20%5Cfrac%7Bdb%7D%7B%5Csqrt%7BS_%7Bdb%7D+%5Cepsilon%7D%7D%24%20%24%5Cepsilon%24%u4E00%u822C%u53D6%u503C%2410%5E%7B-8%7D%24%0A%3E%20%u6548%u679C%u793A%u610F%u56FE%u4E3A%u7EFF%u7EBF%0A%0A%23%23%23%202.8%20Adam%20%u4F18%u5316%u7B97%u6CD5%0AAdam%u4F18%u5316%u7B97%u6CD5%u662F%u628AMomentum%u548CRMSprop%u7B97%u6CD5%u7ED3%u5408%u5728%u4E00%u8D77%20%20%0A%u7B97%u6CD5%u6D41%u7A0B%uFF1A%0A%3E%20%24V_%7Bdw%7D%20%3D%200%2C%20S_%7Bdw%7D%20%3D%200%2C%20V_%7Bdb%7D%20%3D%200%2C%20S_%7Bdb%7D%20%3D%200%24%0A%3E%20%u5728%u8FED%u4EE3%24t%24%uFF1A%0A%3E%20%u4F7F%u7528mini-batch%20%u8BA1%u7B97%20%24dw%24%2C%20%24db%24%0A%3E%20%24V_%7Bdw%7D%20%3D%20%5Cbeta_1V_%7Bdw%7D+%281-%5Cbeta%29dw%2C%20V_%7Bdb%7D%20%3D%20%5Cbeta_1v_%7Bdb%7D+%281-%5Cbeta_1%29db%20%20%24%20%3C-%20%22momentum%22%20%24%5Cbeta_1%24%0A%3E%20%24S_%7Bdw%7D%20%3D%20%5Cbeta_2S_%7Bdw%7D+%281-%5Cbeta_2%29%28dw%29%5E2%2C%20S_%7Bdb%7D%20%3D%20%5Cbeta_2S_%7Bdb%7D+%281-%5Cbeta_2%29%28db%29%5E2%20%24%20%3C-%20%22RMSprop%22%20%24%5Cbeta_2%24%0A%3E%20%5C%23%20%u8981%u8FDB%u884C%u504F%u5DEE%u4FEE%u6B63%0A%3E%20%24V_%7Bdw%7D%5E%7Bcorrected%7D%20%3D%20V_%7Bdw%7D/%281-%5Cbeta_1%5Et%29%2C%20V_%7Bdb%7D%5E%7Bcorrected%7D%20%3D%20V_%7Bdb%7D/%281-%5Cbeta_1%5Et%29%24%0A%3E%20%24S_%7Bdw%7D%5E%7Bcorrected%7D%20%3D%20S_%7Bdw%7D/%281-%5Cbeta_2%5Et%29%2C%20S_%7Bdb%7D%5E%7Bcorrected%7D%20%3D%20S_%7Bdb%7D/%281-%5Cbeta_2%5Et%29%24%0A%3E%20%5C%23%20%u66F4%u65B0%u7CFB%u6570%0A%3E%20%24W%3DW-%5Calpha%20%5Ccdot%20%5Cfrac%7BV_%7Bdw%7D%5E%7Bcorrected%7D%7D%7B%5Csqrt%7BS_%7Bdw%7D%5E%7Bcorrected%7D+%5Cepsilon%7D%7D%2C%20b%20%3D%20b-%5Calpha%5Ccdot%5Cfrac%7BV_%7Bdb%7D%5E%7Bcorrected%7D%7D%7B%5Csqrt%7BS_%7Bdw%7D%5E%7Bcorrected%7D+%5Cepsilon%7D%7D%24%0A%0A------%0A%0A%3E%20%u8D85%u53C2%u6570%u7684%u9009%u62E9%0A%3E%20%24%5Calpha%20%3A%20%u9700%u8981%u8C03%u6574%24%0A%3E%20%24%5Cbeta_1%3A0.9%20-%3E%28dw%29%24%0A%3E%20%24%5Cbeta_2%3A0.999%20-%3E%28dw%5E2%29%24%0A%3E%20%24%5Cepsilon%3A10%5E%7B-8%7D%24%0A%3E%20%u4E00%u822C%u4F7F%u7528%u9ED8%u8BA4%u5C31%u597D%uFF0C%u4E0D%u9700%u8981%u7279%u522B%u4FEE%u6539%0A%3E%20Adam%20%3A%20Adaption%20momentum%20Estimator%0A%0A%23%23%23%202.9%20%u5B66%u4E60%u7387%u8870%u51CF%0A**epoch**%3A%u5B8C%u6574%u7684%u4F7F%u7528%u4E00%u6B21%u5168%u90E8%u6570%u636E%u96C6%20%20%0A-%20%24%5Calpha%20%3D%20%5Cfrac%7B1%7D%7B1+decay%5C_rate*epoch%5C_num%7D%24%0A-%20%24%5Calpha%20%3D%200.95%5E%7Bepoch%5C_num%7D%5Ccdot%20%5Calpha_0%24%0A-%20%24%5Calpha%20%3D%20%5Cfrac%7Bk%7D%7B%5Csqrt%7Bepoch%5C_num%7D%7D%5Ccdot%20%5Calpha_0%24%0A-%20%u79BB%u6563%u5316%u8870%u51CF%0A-%20%u624B%u52A8%u8870%u51CF%0A%0A%23%23%23%202.10%20%u5C40%u90E8%u6700%u4F18%u7684%u95EE%u9898%0A**%u978D%u70B9%28saddle%20point%29**%u95EE%u9898%uFF1A%u5728%u5404%u7EF4%u5EA6%u5BFC%u6570%u4E3A0%uFF0C%u4F46%u90E8%u5206%u7EF4%u5EA6%u662F%u51F8%u51FD%u6570%u9876%u70B9%0A-%20unlikely%20to%20get%20stuck%20in%20a%20bad%20local%20optima%28%u4E0D%u592A%u53EF%u80FD%u9677%u5165%u5C40%u90E8%u6700%u4F18%u7684%u6700%u4F73%u70B9%29%0A-%20Plateaus%20can%20make%20learning%20slow%28%u5E73%u6ED1%u533A%u57DF%u5BFC%u81F4%u5B66%u4E60%u53D8%u6162%uFF0CAdam%u80FD%u52A0%u901F%u5B66%u4E60%u9003%u79BB%29</center><br/></span>
</div></body></html> 